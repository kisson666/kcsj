<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>导入excel表格</title>


		<style type="text/css">
			*{padding:0; margin:0;}
			/*body {background:#F5FAFD;padding:50px 0 0 0;}*/
			.mvBox{height:15px; background:#F5FAFD url(images/loading2.jpg) no-repeat left center; width:471px; position:relative; padding:0 30px; margin:0 auto;}
			.mvBtn{position:absolute; left:50px; top:0;}
			.mvTxt{height:50px; line-height:50px; width:531px; text-align:center; font-size:30px; color:#29B6FF; font-family:Arial; margin:0 auto;}
		</style>


		<meta name="keywords" content="Bootstrap模版,Bootstrap模版下载,Bootstrap教程,Bootstrap中文" />
		<meta name="description" content="站长素材提供Bootstrap模版,Bootstrap教程,Bootstrap中文翻译等相关Bootstrap插件下载" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<!-- basic styles -->

		<link href="assets/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="assets/css/font-awesome.min.css" />

		<!--[if IE 7]>
		  <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css" />
		<![endif]-->

		<!-- page specific plugin styles -->

		<link rel="stylesheet" href="assets/css/jquery-ui-1.10.3.full.min.css" />
		<link rel="stylesheet" href="assets/css/datepicker.css" />
		<link rel="stylesheet" href="assets/css/ui.jqgrid.css" />

		<!-- fonts -->

		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,300" />

		<!-- ace styles -->

		<link rel="stylesheet" href="assets/css/ace.min.css" />
		<link rel="stylesheet" href="assets/css/ace-rtl.min.css" />
		<link rel="stylesheet" href="assets/css/ace-skins.min.css" />

		<!--[if lte IE 8]>
		  <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
		<![endif]-->

		<!-- inline styles related to this page -->

		<!-- ace settings handler -->

		<script src="assets/js/ace-extra.min.js"></script>

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->

		<!--[if lt IE 9]>
		<script src="assets/js/html5shiv.js"></script>
		<script src="assets/js/respond.min.js"></script>
		<script src="js/jquery.min.js"></script>
		<![endif]-->
	</head>
<body>
	<div class="navbar navbar-default" id="navbar">
		<script type="text/javascript">
			try{ace.settings.check('navbar' , 'fixed')}catch(e){}
		</script>

		<div class="navbar-container" id="navbar-container">
			<div class="navbar-header pull-left">
				<a href="#" class="navbar-brand">
					<small>
						<i class="icon-leaf"></i>
						课程设计 学生信息管理系统
					</small>
				</a><!-- /.brand -->
			</div><!-- /.navbar-header -->

			<div class="navbar-header pull-right" role="navigation">
				<ul class="nav ace-nav">

					<li class="light-blue">
						<a data-toggle="dropdown" href="#" class="dropdown-toggle">
							<img class="nav-user-photo"  id="user_ico_kisson" alt="user_ico" />
							<span class="user-info">
									<small>欢迎光临,</small>
									<div id="user_realName_kisson">admin</div>
								</span>

							<i class="icon-caret-down"></i>
						</a>

						<ul class="user-menu pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">

							<li class="divider"></li>

							<li>
								<a href="/user/exit">
									<i class="icon-off"></i>
									退出
								</a>
							</li>
						</ul>
					</li>
				</ul><!-- /.ace-nav -->
			</div><!-- /.navbar-header -->
		</div><!-- /.container -->
	</div>

		<div class="main-container" id="main-container">
			<script type="text/javascript">
				try{ace.settings.check('main-container' , 'fixed')}catch(e){}
			</script>

			<div class="main-container-inner">
				<a class="menu-toggler" id="menu-toggler" href="#">
					<span class="menu-text"></span>
				</a>

				<div class="sidebar" id="sidebar">
					<script type="text/javascript">
						try{ace.settings.check('sidebar' , 'fixed')}catch(e){}
					</script>

					<ul class="nav nav-list">
						<li class="active">
							<a href="/index.html">
								<i class="icon-desktop"></i>
								<span class="menu-text"> 首页 </span>
							</a>
						</li>

						<li>
							<a href="/query.html">
								<i class="icon-search nav-search-icon"></i>
								<span class="menu-text">查询学生信息</span>
							</a>
						</li>



						<li>
							<a href="/excel.html" class="dropdown-toggle">
								<i class="icon-list"></i>
								<span class="menu-text"> 导入excel表格 </span>
							</a>


						</li>

						<li>
							<a href="/userInfo/userList" class="dropdown-toggle">
								<i class="icon-list-alt"></i>
								<span class="menu-text">查询用户信息</span>
							</a>
						</li>

						<li>
							<a href="/log.html">
								<i class="icon-file-alt"></i>
								<span class="menu-text">查看用户操作日志</span>
							</a>
						</li>

						<li>
							<a href="calendar.html">
								<i class="icon-calendar"></i>

								<span class="menu-text">
									日历
									<span class="badge badge-transparent tooltip-error" title="2&nbsp;Important&nbsp;Events">
										<i class="icon-warning-sign red bigger-130"></i>
									</span>
								</span>
							</a>
						</li>

						<li>
							<a href="gallery.html">
								<i class="icon-picture"></i>
								<span class="menu-text"> 相册 </span>
							</a>
						</li>

						<li>
							<a href="#" class="dropdown-toggle">
								<i class="icon-tag"></i>
								<span class="menu-text"> 更多页面 </span>

								<b class="arrow icon-angle-down"></b>
							</a>

							<ul class="submenu">
								<li>
									<a href="profile.html">
										<i class="icon-double-angle-right"></i>
										用户信息
									</a>
								</li>

								<li>
									<a href="inbox.html">
										<i class="icon-double-angle-right"></i>
										收件箱
									</a>
								</li>

								<li>
									<a href="pricing.html">
										<i class="icon-double-angle-right"></i>
										售价单
									</a>
								</li>

								<li>
									<a href="invoice.html">
										<i class="icon-double-angle-right"></i>
										购物车
									</a>
								</li>

								<li>
									<a href="timeline.html">
										<i class="icon-double-angle-right"></i>
										时间轴
									</a>
								</li>

								<li>
									<a href="login.html">
										<i class="icon-double-angle-right"></i>
										登录 &amp; 注册
									</a>
								</li>
							</ul>
						</li>

						<li>
							<a href="#" class="dropdown-toggle">
								<i class="icon-file-alt"></i>

								<span class="menu-text">
									其他页面
									<span class="badge badge-primary ">5</span>
								</span>

								<b class="arrow icon-angle-down"></b>
							</a>

							<ul class="submenu">
								<li>
									<a href="faq.html">
										<i class="icon-double-angle-right"></i>
										帮助
									</a>
								</li>

								<li>
									<a href="error-404.html">
										<i class="icon-double-angle-right"></i>
										404错误页面
									</a>
								</li>

								<li>
									<a href="error-500.html">
										<i class="icon-double-angle-right"></i>
										500错误页面
									</a>
								</li>

								<li>
									<a href="grid.html">
										<i class="icon-double-angle-right"></i>
										网格
									</a>
								</li>

								<li>
									<a href="blank.html">
										<i class="icon-double-angle-right"></i>
										空白页面
									</a>
								</li>
							</ul>
						</li>
					</ul><!-- /.nav-list -->

					<div class="sidebar-collapse" id="sidebar-collapse">
						<i class="icon-double-angle-left" data-icon1="icon-double-angle-left" data-icon2="icon-double-angle-right"></i>
					</div>

					<script type="text/javascript">
						try{ace.settings.check('sidebar' , 'collapsed')}catch(e){}
					</script>
				</div>

				<div class="main-content">

					<div class="page-content">
						<div class="page-header" id="index_header_kisson">
							<h1>

								导入excel表格

							</h1>
						</div><!-- /.page-header -->

						<div class="row">
							<div class="col-xs-12" >
								<!-- PAGE CONTENT BEGINS -->
								<div id="loading_kisson" style="display: none">
									<div class="mvTxt">正在导入，请等待<span class="mvSq">.</span><span class="mvSq">.</span><span class="mvSq">.</span></div>
									<div class="mvBox">
										<img class="mvBtn" src="images/loading1.jpg" />
									</div>
								</div>
								<div id="excel_from_kisson">
									<form enctype="multipart/form-data" id="batchUpload"  action="user/upload" method="post" class="form-horizontal">
										<button class="btn btn-success btn-xs" id="uploadEventBtn" style="height:26px;"  type="button" >选择文件</button>
										<input type="file" name="stu_excel"  style="width:0px;height:0px;" id="uploadEventFile">
										<input id="uploadEventPath"  disabled="disabled"  type="text" placeholder="请选择excel表" style="border: 1px solid #e6e6e6; height: 26px;width: 200px;" >
									</form>
									<button type="button" class="btn btn-success btn-sm"  onclick="user.uploadBtn()" >上传</button>
								</div>
								<!-- PAGE CONTENT ENDS -->

							</div><!-- /.col -->
						</div><!-- /.row -->
					</div><!-- /.page-content -->
				</div><!-- /.main-content -->

			</div><!-- /.main-container-inner -->

			<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
				<i class="icon-double-angle-up icon-only bigger-110"></i>
			</a>
		</div><!-- /.main-container -->

		<!-- basic scripts -->

		<!--[if !IE]> -->

		<!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>-->

		<!-- <![endif]-->

		<!--[if IE]>
<!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>-->

		<!--[if !IE]> -->

		<script type="text/javascript">
			window.jQuery || document.write("<script src='assets/js/jquery-2.0.3.min.js'>"+"<"+"/script>");
		</script>

		<!-- <![endif]-->

		<!--[if IE]>
<script type="text/javascript">
 window.jQuery || document.write("<script src='assets/js/jquery-1.10.2.min.js'>"+"<"+"/script>");
</script>
<![endif]-->

		<script type="text/javascript">
			if("ontouchend" in document) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
		</script>
		<script src="assets/js/bootstrap.min.js"></script>
		<script src="assets/js/typeahead-bs2.min.js"></script>

		<!-- page specific plugin scripts -->

		<script src="assets/js/date-time/bootstrap-datepicker.min.js"></script>
		<script src="assets/js/jqGrid/jquery.jqGrid.min.js"></script>
		<script src="assets/js/jqGrid/i18n/grid.locale-en.js"></script>

		<!-- ace scripts -->

		<script src="assets/js/ace-elements.min.js"></script>
		<script src="assets/js/ace.min.js"></script>

		<!-- inline scripts related to this page -->

		<script src="js/ajaxfileupload1.js"></script>
	<script>

		<!--以下为自己写的js-->

		var response;
		$(function () {  //$(function)是指等页面加载完成后才执行  跟把js函数放到body最后的效果差不多    //这段函数开始放在页面最前面 结果不能执行 放到最后就可以了 估计是引入文件的先后问题
			$.ajax({
				url:'/user/userInfo',
				type:'get',
				dataType:'json',
				async:true,   //默认是true 即异步调用 暂且理解是多线程 异步的话ajax函数还没执行完就执行接下来的函数了 所以下面的函数在response还没被赋值的时候就用了 会报错 只能写在success里面
				success:function (res) {
					response = res;
					$('#user_realName_kisson').text(response.body.user.realName);
					$('#user_ico_kisson').attr("src",response.body.user.ico);
				}
			});
		});

	</script>



	<script language="javascript">
		var delVal=50;
		function autoMove(){
			delVal++;
			if(delVal>400){
				delVal=50;
			}
			$(".mvBtn").css("left",delVal);
		}
		setInterval(autoMove,8);
		var deNum=0;
		function autoTsq(){
			$(".mvSq").css("color","#F5FAFD");
			setTimeout(function(){$(".mvSq").eq(0).css("color","#29B6FF")},0);
			setTimeout(function(){$(".mvSq").eq(1).css("color","#29B6FF")},500);
			setTimeout(function(){$(".mvSq").eq(2).css("color","#29B6FF")},1000);
		}
		setInterval(autoTsq,1500);
	</script>


	<script>
		var User = function(){

			this.init = function(){

				//模拟上传excel
				$("#uploadEventBtn").unbind("click").bind("click",function(){
					$("#uploadEventFile").click();
				});
				$("#uploadEventFile").bind("change",function(){
					$("#uploadEventPath").attr("value",$("#uploadEventFile").val());
				});

			};
			//点击上传按钮
			this.uploadBtn = function(){
				var uploadEventFile = $("#uploadEventFile").val();
				if(uploadEventFile == ''){
					alert("请选择excel,再上传");
				}else if(uploadEventFile.lastIndexOf(".xls")<0){//可判断以.xls和.xlsx结尾的excel
					alert("只能上传Excel文件");
				}else{
					var url =  '/upload/excel';
					user.sendAjaxRequest(url,'POST');
				}
			};

			this.sendAjaxRequest = function(url,type){
				$('#loading_kisson').show();
				$('#excel_from_kisson').hide();
				$.ajaxFileUpload({
					url : url,
					type : type,
					secureuri:false,
					fileElementId:'uploadEventFile',
					success : function(data) {
						$('#loading_kisson').hide();
						$('#excel_from_kisson').show();
						var str = $(data).find("body").text();  //将html格式转换为json格式
						var response =  $.parseJSON(str);
						alert(response.errmsg);

					},
					error : function() {
						$('#excel_from_kisson').show();
						$('#loading_kisson').hide();
						alert( "excel上传失败");
					}
//					cache : false,
//					contentType : false,
//					processData : false
				});
			};
		}


		var user;
		$(function(){
			user = new User();
			user.init();
		});

	</script>

	<!--<div style="display:none"><script src='http://v7.cnzz.com/stat.php?id=155540&web_id=155540' language='JavaScript' charset='gb2312'></script></div>-->
</body>
</html>
